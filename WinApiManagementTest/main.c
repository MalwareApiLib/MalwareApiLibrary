#include <Windows.h>
#include <stdio.h>
#include "ExpApiManagement.h"

#pragma comment (lib, "WinApiManagementLib.lib")


int main() {

	PVOID hKernel32 = GetModuleHandleByNameA("kernel32.dll");
	printf("[+] hKernel32 1 : 0x%p \n", hKernel32);

#define KERNEL32HASH 0x228c4218

	hKernel32 = GetModuleHandleByHash(KERNEL32HASH, 7);
	printf("[+] hKernel32 2 : 0x%p \n", hKernel32);

	GetModuleHandleByNameW(L"kernel32.dll");
	printf("[+] hKernel32 3 : 0x%p \n", hKernel32);


	
	PVOID pVirtualAlloc = GetProcAddressByName(hKernel32, "VirtualAlloc");
	printf("[+] pVirtualAlloc 1 : 0x%p \n", pVirtualAlloc);


#define VIRTUALALLOCHASH 0x1ede5967
	pVirtualAlloc = GetProcAddressByHash(hKernel32, VIRTUALALLOCHASH, 7);
	printf("[+] pVirtualAlloc 2 : 0x%p \n", pVirtualAlloc);

	return 0;
}