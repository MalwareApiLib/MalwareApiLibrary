#pragma once

#ifndef _COMMON_H
#define _COMMON_H

#include <Windows.h>

typedef struct _VX_TABLE_ENTRY {
	PVOID   pAddress;
	DWORD64 Rotr32Hash;
	WORD    wSystemCall;
	INT     Rotr32Seed;
} VX_TABLE_ENTRY, * PVX_TABLE_ENTRY;

//VX_TABLE_ENTRY VxTbleEntry = { 0 };

typedef struct NtdllConfig {
	PVOID pNtdll;
	PIMAGE_DOS_HEADER pDosHdr;
	PIMAGE_NT_HEADERS pNtHdr;
	PIMAGE_EXPORT_DIRECTORY pIED;
	PDWORD pdwAddressOfFunctions;
	PDWORD pdwAddressOfNames;
	PWORD pwAddressOfNameOrdinales;
};

//struct NtdllConfig NtdllConfigStruct = { 0 };


typedef struct MyStruct {
	PIMAGE_EXPORT_DIRECTORY pImageExportDirectory;
	PDWORD pdwAddressOfFunctions;
	PDWORD pdwAddressOfNames;
	PWORD pwAddressOfNameOrdinales;
	INT	Seed;
};

//struct MyStruct ConfigStruct = { 0 };





INT HashStringRotr32A(PCHAR String, INT Seed);



#endif // !_COMMON_H
